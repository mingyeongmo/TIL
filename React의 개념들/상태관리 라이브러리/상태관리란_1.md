# 프론트엔드의 상태관리란 무엇인가?

---

## 다룰 내용

- 상태란 무엇인가?
- 상태관리란 무엇인가?
- 후기

## 상태란 무엇인가?

상태는 영어로 state라고 합니다. 이를 한국어로 번역해서 '상태'라고 부르는데, 저는 상태라기보다는 데이터라고 부르는게 이해하기 쉽다고 생각합니다.

객체 지향 프로그래밍에서는 프로그램의 기본 단위가 객체이고, 객체간의 메세지 상호작용을 통해 프로그램을 구현하게 됩니다. 이때 객체가 가지고 있는 데이터 또한 상태라고 할 수 있습니다. 예를 들어 다음 코드 예시처럼 `Car` 클래스를 만든다고 가정하면 자동차의 상태는 `color` 와 `type` 이 됩니다.

```
type CarType = 'suv' | 'bus' | 'truck'

class Car {
    color: string // 자동차의 색상 상태
    type: CarType // 트럭인지 버스인지 등 자동차의 종류 상태
    constructor(color: string, type: CarType) {
        this.color = color
        this.type = type
    }
}
```

그렇다면 어려운 Class 말고, 화면 기준으론 어떤 상태가 있을까요? 제 개인 인스타그램 화면을 예시로 보겠습니다.

![instagram](https://miro.medium.com/max/1000/1*d6zNJQN_3F0f01Au6e-w1A.jpeg)

앞서 저는 상태는 데이터라고 했습니다. 위 스크린샷에 필요한 데이터는 어떤게 있을까요?

대충 추려보면 다음과 같은 데이터가 필요합니다.

- 내가 올린 사진들
- 게시물 수
- 팔로워 수
- 팔로잉 수
- 새로운 알림
- 이름,닉네임
- 내가 현재 로그인이 되어있는지 여부
- 내가 태그된 게시물
- 데이터들이 서버로부터 로딩이 완료되었는지 여부

이 모든 것은 화면 구성에 필요한 데이터이고 이를 **상태**라고 부릅니다.

## 상태관리란 무엇인가?

그렇다면 상태관리란 무엇일까요?

저는 데이터에 맞춰 적절하게 UX와 UI를 설계하고 구현하는게 상태관리라고 생각합니다.

첫번째로 저는 팔로워 수가 59명 밖에 없지만, 팔로워 수가 많아져서 2.1억명을 넘었다고 가정해보겠습니다.

![2.1억팔로워](https://miro.medium.com/max/848/1*h2PikqQVci33-FaU3R87fQ.jpeg)

59는 숫자의 길이가 2글자 밖에 안되므로 표기하는데 전혀 문제되지 않습니다. 하지만 2.1억을 210000000이라고 표기하는 것은 읽기도 힘들고 너무 길어서 UI가 이상해집니다. 그럴바엔 아래 스크린샷 처럼 2.1억이라고 표기하는게 더 짧고 읽기 쉽고 UI에 들어맞습니다.

팔로워 상태에 따라 UI가 동적으로 변했습니다. 팔로워 수 표기의 상태관리 입니다.

![두번째경우](https://miro.medium.com/max/1000/1*wF9P3I1nahXmmf-07GqZag.jpeg)

두번째 경우도 상태에 따라 UI가 동적으로 변하는 예시입니다. 게시물 리스트는 모두 비슷한 모양을 하고 있지만, 사진이 여러장인지, 동영상인지 여부에 따라 아이콘을 각각 다르게 보여주고 있습니다. 이는 컴포넌트를 만들어두고, 게시물 상태에 따라 UI가 다르게 반응한 경우입니다.

![세번째경우](https://miro.medium.com/max/1000/1*_qYbOcZrXg9-TzVUby51Dg.jpeg)

세번째로 제가 올린 게시글에 새로운 댓글이 달렸다고 실시간으로 알림이 온 경우입니다. 위 스크린샷 하단에 보면 UI가 변한것을 알 수 있습니다. 이것 또한 상태관리입니다.

![네번째경우](https://miro.medium.com/max/1000/1*MgQbDnY5YQlbjnLGNLGQRw.jpeg)

네 번째는 로딩 상태 관리입니다. 위 스크린샷은 제 인스타 피드에 접속할 때 찰나의 순간을 캡쳐한 것입니다. 보시면 게시물 정보를 다 불러오기 전에 검정색 박스 UI만 노출되고 있습니다. 이런 UI를 Skeleton UI라고 부르며, 용량이 큰 데이터나 사진 등의 정보를 로딩할 때 사용자에게 피드백을 주기 위해 사용합니다.

![다섯번째](https://miro.medium.com/max/1000/1*YAGkt_96GonDnn7J-nv2Qg.png)

다섯 번째는 에러 예외 상황에 대한 상태관리입니다. 위 스크린샷에서 저는 의도적으로 인터넷 연결을 끊었습니다. 그랬더니 빨간색 알림 영역이 생기고, '인터넷 연결 없음'이라는 문자가 표시되었습니다. 개발 시 예외처리는 매우 중요합니다. 상태관리는 예외적으로 발생할 수 있는 경우를 고려해서 적절한 피드백을 주기 위해 사용하기도 합니다.

## 후기

프론트엔드에서 쓰이는 상태는 매우 종류가 많고 상태의 조압에 따른 경우의 수를 다 고려해야 합니다. 이 글에서 언급했던 상태 외에도 다음과 같은 상태 등이 있습니다.

- 화면 내에 특정 UI를 노출할지 여부
- 현재 보고 있는 페이지
- 로그인한 유저의 권한
- text input의 입력 값
- checkbox input의 선택 여부

그리고 최근 프론트엔드 개발의 기본 단위는 재사용 가능한 컴포넌트입니다. 이 컴포넌트 간의 상태의 공유 여부로 **지역적 상태**(local state) 또는 **전역적 상태**(global state)를 적절히 구분해서 설계해야 합니다. 또한 상태는 일관적인 형태를 유지해서 무결성을 지켜야합니다. 예를 들어서 팔로워수를 표시하는 화면이 3군데 있다고 가정해봅시다. 상태가 일관적이지 않으면 3화면 다 다른 팔로워 수를 표시할 수 있습니다. 팔로워가 실시간으로 증가했으면 3화면 다 같은 데이터를 보여주어야 합니다.

또한 상태를 어디에 어떻게 저장하고 사용할건지도 중요합니다. 상태 공유 여부에 다라 전역적으로 redux나 vuex 같은 스토어에 저장하던지, 브라우저가 꺼져도 상태가 유지되도록 브라우저의 쿠키(Cookie) 또는 로컬 스토리지(localStorage)에 저장하는 것도 고려할 수 있습니다. 심지어 url의 상태 값을 포함시켜서 관리도 가능합니다. 백엔드와 실시간 소통이 중요하다면 웹소켓으로 관리할 수도 있습니다.

그리고 상태와 상태의 조합에 따른 경우의 수가 굉장히 많습니다. 예를 들어서 0과 1의 이진법 2자리 상태가 있으면 총 상태는 00,01,10,11로 4가지가 됩니다. 이렇게 조합으로 나올 수 있는 경우의 수를 다 고려하고 우선순위를 설정해서 UI에 반영하는 작업 또한 매우 중요한 작업입니다.

## 출처

[ashnamuh](https://medium.com/wematch/%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%94%EB%93%9C%EC%9D%98-%EC%83%81%ED%83%9C%EA%B4%80%EB%A6%AC%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80-5ff888dab7ad)
